<!DOCTYPE html>
<html lang="en">
<head>
    <title>Log In | BookHub Digital Library</title>    
    <link rel="stylesheet" href="css/style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://kit.fontawesome.com/64b31fc025.js" crossorigin="anonymous"></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
    <header class="auth-header">
        <div class="logo d-flex align-items-center">
            <i class="fa-solid fa-book-open-reader fs-2 text-white me-2"></i>
            <span class="text-white fs-3 fw-bold">BookHub</span>
        </div>
    </header>

    <!-- Main Login Content -->
    <main class="auth-main">
        <div class="container d-flex justify-content-center align-items-center">
            <div class="auth-box login">
                <section>
                    <div class="text-center mb-4">
                        <h2 class="fw-bold">Welcome Back</h2>
                        <p class="text-muted">Please enter your details</p>
                    </div>
                </section>
                
                <form id="loginForm" class="user">
                    <div class="mb-3 form-group">
                        <input type="text" id="userInput" class="form-control form-control-user"
                               placeholder="Enter Username" name="user" required>
                    </div>
                    
                    <div class="mb-3 form-group">
                        <input type="password" id="pwdInput" class="form-control form-control-user"
                               placeholder="Password" name="pwd" required>
                    </div>
                    
                    <div class="mb-3 form-check">
                        <input type="checkbox" class="form-check-input" id="rememberMe">
                        <label class="form-check-label" for="rememberMe">Remember me</label>
                    </div>
                    
                    <div class="mb-3">
                        <input type="submit" class="btn btn-primary btn-user w-100" value="Login">
                    </div>
                </form>
                
                <hr>
                
                <div class="text-center">
                    <p class="mb-3">Not a Member?</p>
                    <a href="register.html" class="btn btn-outline-primary">
                        <i class="fas fa-user-plus me-2"></i>SIGN UP
                    </a>
                </div>
                
                <div id="loginError" class="alert mt-3 d-none"></div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="social-media">
            <a href="#"><i class="fab fa-facebook"></i></a>
            <a href="#"><i class="fab fa-twitter"></i></a>
            <a href="#"><i class="fab fa-instagram"></i></a>
        </div>
        <p>&copy; by BookHub Digital Library | All Rights Reserved</p>
        <p>Last updated: 2025</p>
    </footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    
<script>
    const loginForm = document.getElementById('loginForm');
    const loginError = document.getElementById('loginError');

    loginForm.addEventListener('submit', function(e) {
        e.preventDefault();

        const userVal = document.getElementById('userInput').value;
        const pwdVal = document.getElementById('pwdInput').value;

        // 1. Ambil data users dari LocalStorage
        const users = JSON.parse(localStorage.getItem('users_db')) || [];

        // 2. Cari user yang match dengan username DAN password
        const foundUser = users.find(u => u.username === userVal && u.password === pwdVal);

        // Reset rupa mesej
        loginError.classList.add('d-none');
        loginError.classList.remove('alert-danger', 'alert-success');

        if (foundUser) {
            // JIKA BERJAYA
            loginError.classList.remove('d-none');
            loginError.classList.add('alert-success');
            loginError.innerText = "You are now logged in! Welcome back " + foundUser.fullname;
            
            // 3. SET CURRENT USER dalam localStorage - INI YANG PENTING!
            localStorage.setItem('current_user', JSON.stringify(foundUser));
            
            // 4. Tunggu 2 saat baru pergi ke home page
            setTimeout(() => {
                window.location.href = 'index.html'; // atau 'dashboard.html'
            }, 2000);

        } else {
            // JIKA GAGAL
            loginError.classList.remove('d-none');
            loginError.classList.add('alert-danger');
            loginError.innerText = "Invalid Username or Password!";
        }
    });
</script>
</body>
</html>